<script>$( function(){    $("#navbar-index").addClass("active");    showActivities();    $(window).scroll(function() {			if (document.body.clientHeight - document.documentElement.scrollTop -  document.documentElement.clientHeight <= 10 ){				addIndexActivityShow();			}	});});var current_top = 20;var current_left = 0;var page_offset = 0;var limit = 6;var current_id_num = 0;var image_width = 210;var refresh_lock = false;function showActivities(){		if (!refresh_lock) {			refresh_lock = true;			$.ajax({				url:"__('base_ajax_action_controller/getNewActivityInformation'|site_url)__",				data:'page_offset='+page_offset+'&limit='+limit,				type: "GET",				dataType: "JSON",				async: false,				success:function(data){					for(i in data){						current_id_num++;						current_id = 'ia_'+ current_id_num;						var newActivity = '<div class="main-showcase-item id='+current_id+'">'+'<a href="__("activity/view"|site_url)__?id='+data[i].activity_id+'">'+'<img src="'+data[i].activity_image+'" class="img-rounded"></a>'+'<h3><a href="__("activity/view"|site_url)__?id='+data[i].activity_id+'">'+data[i].activity_name+'</a></h3>'+'<ul>'+'<li>开始时间: '+data[i].start_time+'</li>'+'<li>结束时间: '+data[i].end_time+'</li>'+'<li>发起人: <a href="__("member"|site_url)__?id='+data[i].member_id+'">'+data[i].member_name+'</a></li>'+'<li><code>'+data[i].attend_number+'</code>人参与&nbsp;&nbsp;|&nbsp;&nbsp;<code>'+data[i].attention_number+'</code>人关注</li>'+'</ul></div>';						$("#main-showcase").append(newActivity);												$('#'+current_id).css('top',current_top);						$('#'+current_id).css('left',current_left);						$('#'+current_id).css('display','none');																		//calculate top parameter						if (current_id_num < 3) {							current_top = 20;						}else {							previous_id = '#ia_'+(current_id_num + 1 - 3);							//alert(previous_id);							previous_div = $(previous_id);							previous_div_position = previous_div.position();							previous_div_position_top = previous_div_position.top;														current_top = parseFloat(previous_div_position_top) + parseFloat(previous_div.outerHeight()) + 20;						}												$('#'+current_id).fadeIn("slow");	//这边会因为展开速度过慢而导致高度错误						current_left = (current_id_num%3)*250 + (current_id_num%3)*20;					}					page_offset = page_offset +  limit;					refresh_lock = false;				}			});		}	}</script>