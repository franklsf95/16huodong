<script src="{$config.asset}/js/jquery.validate.min.js"></script><script>$("#modal-compose").modal('show');//Ctrl+Enter for submission$("#message-compose-form").keydown(function(e) {	if (e.ctrlKey && e.keyCode == 13) {    	$("#message-compose-form").submit();  	}});$(".form-submit").click(function(){	$("#message-compose-form").submit();});$("#message-compose-form").validate({	rules: {		member_id : {			required: true		},		message_content : {			required: true		}	}});$("#member-selector").keydown(function(){	if( event.keyCode == 13 ) {		member_name = $("#member-selector").val();		if(member_name != '') {			$.getJSON("{'message/ajaxGetFriendBasicByName'|site_url}?query="+member_name,function(data) {					$("#member-list").empty();					if (data.length > 0) {						for(i in data){							var member_list = '<div class="member-click" id="m-'+data[i].member_id+'" onclick="selectMember('+data[i].member_id+')">'+								'<img class="avatar-small" src="'+data[i].member_image+'" alt="'+data[i].member_name+'">'+								'<span class="member-name">'+data[i].member_name+'</span>'+								'</div>';								$("#member-list").append(member_list);															}					} else {						$("#member-list").append('无好友');					}			});		}	}});function removeMember(id) {	$('#m-'+id).removeClass('member-selected');	$('#t-'+id).remove();}function selectMember(id) {	if( ! $('#m-'+id).hasClass('member-selected') ) {		name = $('#m-'+id+' .member-name').html();		$('#m-'+id).addClass('member-selected');		newTag = '<span class="badge tag" id="t-'+id+'" onclick="removeMember('+id+')">'+name+'<input type="hidden" name="member_list[]" value="'+id+'"></span>';    	$(".tag-list").append( newTag );	}}</script>