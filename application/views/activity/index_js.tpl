<script src="{$config.asset}/js/jquery.wookmark.js"></script><script>$( function(){    showActivities();});$(window).scroll(function() {	var top = document.documentElement.scrollTop + document.body.scrollTop;	var bodyheight = $(document).height();	if (bodyheight - top - $(window).height() <= 100) {		showActivities();	}});$("#navbar-activity").addClass("active");$(".tag").click(function() {	reloadActivities( $(this).html() );});var page_offset = 0;var limit = 3;var refresh_lock = false;var wmOptions = {      autoResize: true,      container: $('#waterfall'),      itemWidth: 280    };var handler = null;function showActivities() {	if (!refresh_lock) {		refresh_lock = true;		$.getJSON("{'activity/ajaxGetLatestActivities'|site_url}", {			"page_offset": page_offset,			"limit": limit		}, function(data) {			for(i in data) {				$("#waterfall").append( wrapActivity( i+1, data[i]) ).fadeIn('slow');			}			if(handler) handler.wookmarkClear();			handler = $("#waterfall li");			handler.wookmark(wmOptions);			page_offset += limit;			refresh_lock = false;		});	}}function reloadActivities( tag ) {	$('#waterfall').fadeOut('fast');	$('#waterfall').empty();	$.getJSON("{'activity/ajaxGetActivityInformationByTag'|site_url}",{ "tag":tag }, function(data) {		console.log(data);		$("#waterfall").fadeIn('fast');		if( data.length == 0 ) {			$('#waterfall').append("<p>无结果</p>");		} else {			for( i in data ) {				activity = wrapActivity( i+1, data[i] );				$("#waterfall").append( activity );			}		}	});}function wrapActivity( id, act ) {	var a = '<li class="wm-item" id="item-'+id+'">'+'<a href="{"activity/view"|site_url}?id='+act.activity_id+'">'+'<img src="'+act.activity_image+'" class="img-rounded"></a>'+'<h4><a href="{"activity/view"|site_url}?id='+act.activity_id+'">'+act.activity_name+'</a></h4>'+'<div class="wm-ul">'+'<div>开始时间: '+act.start_time+'</div>'+'<div>结束时间: '+act.end_time+'</div>'+'<div>发起人: <a href="{"profile"|site_url}?id='+act.publisher_id+'">'+act.publisher_name+'</a></div>'+'<div><code>'+act.attend_count+'</code>人参与&nbsp;&nbsp;|&nbsp;&nbsp;<code>'+act.follow_count+'</code>人关注</div>'+'</div></li>';	return a;}</script>